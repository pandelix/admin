(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43959db9"],{3835:function(t,e,i){"use strict";function n(t){if(Array.isArray(t))return t}i.d(e,"a",(function(){return s}));i("a4d3"),i("e01a"),i("d28b"),i("e260"),i("d3b7"),i("3ca3"),i("ddb0");function a(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,a=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(i.push(o.value),e&&i.length===e)break}catch(c){a=!0,r=c}finally{try{n||null==s["return"]||s["return"]()}finally{if(a)throw r}}return i}}var r=i("06c5");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){return n(t)||a(t,e)||Object(r["a"])(t,e)||o()}},"441c":function(t,e,i){"use strict";i("4160"),i("c975"),i("d81d"),i("fb6a"),i("ac1f"),i("1276"),i("498a"),i("159b");var n,a,r=i("2638"),o=i.n(r),s=i("53ca"),c=i("3835"),l=i("5530"),u=i("e572"),f=i("6d97"),p=i("b047"),h=i.n(p),m={name:"TypeInput",components:{FilePicker:f["a"]},data:function(){return{filePickerKey:1}},props:{type:String,value:null,options:Object},computed:Object(l["a"])({},Object(u["f"])(["CONFIG_TYPES"]),{selectOptions:function(){if(this.type!==this.CONFIG_TYPES.SINGLE_SELECT&&this.type!==this.CONFIG_TYPES.MULTIPLE_SELECT)return[];var t=this.options.options.split("\n"),e=[];return t.forEach((function(t){var i=t.split("=>").map((function(t){return t.trim()})),n=Object(c["a"])(i,2),a=n[0],r=n[1];r&&e.push({value:a,label:r})})),e}}),methods:{onInput:function(t){this.$emit("input",t)},initValue:function(){this.type===this.CONFIG_TYPES.FILE?this.options.max>1&&!Array.isArray(this.value)?this.onInput(this.value?[this.value]:[]):this.options.max<=1&&Array.isArray(this.value)&&this.onInput(this.value[0]||null):this.type===this.CONFIG_TYPES.MULTIPLE_SELECT?!Array.isArray(this.value)&&this.onInput([]):-1===["string","boolean","number"].indexOf(Object(s["a"])(this.value))&&this.onInput(null)},updateFilePicker:h()((function(){this.filePickerKey++}),500)},watch:{type:{handler:function(){this.initValue()},immediate:!0},"options.max":function(t,e){t>1&&e>1||this.updateFilePicker(),this.initValue(),t>1&&t<e&&this.onInput(this.value.slice(0,t))},"options.ext":function(){this.updateFilePicker()}},render:function(t){var e,i={attrs:{value:this.value},on:{}},n=null,a=null,r=this.CONFIG_TYPES;switch(this.type){case r.INPUT:case r.OTHER:n="a-input",e="change.value";break;case r.TEXTAREA:n="a-input",e="change.value",i.attrs.type="textarea";break;case r.FILE:n="file-picker",e="input",Object.assign(i.attrs,{max:this.options.max,ext:this.options.ext,multiple:this.options.max>1}),i.key=this.filePickerKey;break;case r.SINGLE_SELECT:case r.MULTIPLE_SELECT:var s=this.type===r.MULTIPLE_SELECT;if("input"===this.options.type){n=s?"a-checkbox-group":"a-radio-group",e="input";var c=s?"a-checkbox":"a-radio";a=this.selectOptions.map((function(e){return t(c,{key:e.value,attrs:{value:e.value}},[e.label])}))}else"select"===this.options.type&&(n="a-select",e="change",Object.assign(i.attrs,{mode:s?"multiple":"default",allowClear:s}),a=this.selectOptions.map((function(e){return t("a-select-option",{key:e.value,attrs:{value:e.value}},[e.label])})));break;default:}return i.on[e]=this.onInput,t(n,o()([{},i]),[a])}},d=m,v=i("2877"),b=Object(v["a"])(d,n,a,!1,null,null,null);e["a"]=b.exports},"498a":function(t,e,i){"use strict";var n=i("23e7"),a=i("58a8").trim,r=i("c8d2");n({target:"String",proto:!0,forced:r("trim")},{trim:function(){return a(this)}})},"6d97":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"file-picker"},[i("div",{staticClass:"file-wrapper"},[t._l(t.arrayValue,(function(e,n){return i("file-preview",{key:n,staticClass:"preview file-item",attrs:{file:e}},[i("a-icon",{staticClass:"replace",attrs:{type:"sync",title:"替换"},on:{click:function(e){return e.stopPropagation(),t.onReplace(n)}}}),i("lz-popconfirm",{attrs:{title:"确认移除？",confirm:function(){return t.remove(n)}}},[i("a-icon",{staticClass:"remove",attrs:{type:"delete",title:"移除"}})],1)],1)})),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isMax,expression:"!isMax"}],staticClass:"picker file-item flex-box",on:{click:t.onPick}},[i("svg-icon",{staticClass:"file-icon",attrs:{"icon-class":t.pickerIcon}})],1)],2),i("a-modal",{attrs:{title:t.title,width:"90%",footer:null,"wrap-class-name":"system-media-dialog"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("system-media",{ref:"media",attrs:{"default-multiple":t.mediaMultiple,"default-ext":t.ext},scopedSlots:t._u([{key:"actions",fn:function(e){return[i("a-button",{attrs:{type:"primary",disabled:!e.anySelected},on:{click:function(i){return t.onPickConfirm(e.selected)}}},[t._v(" 选定 ")])]}}])})],1)],1)},a=[],r=(i("99af"),i("d81d"),i("fb6a"),i("a434"),i("a9e3"),i("d3b7"),i("ac1f"),i("6062"),i("3ca3"),i("1276"),i("ddb0"),i("2909")),o=i("5530"),s=i("8a59"),c=i("2847"),l=i("2593"),u=i.n(l),f=i("1028"),p={name:"FilePicker",components:{LzPopconfirm:f["a"],FilePreview:c["a"],SystemMedia:s["a"]},inject:{lzFormItem:{default:null}},data:function(){return{dialog:!1,formattedValue:null,pickIndex:-1}},props:{multiple:Boolean,max:{type:[String,Number],default:8},title:{type:String,default:function(){var t;return(null===(t=this.lzFormItem)||void 0===t?void 0:t.label)||"选择文件"}},value:null,ext:String,valueFields:{type:String,default:"path"},flatValue:{type:Boolean,default:!0}},computed:{pickerIcon:function(){return this.multiple?"multi-file":"single-file"},canPick:function(){return!this.isMax||this.isReplace},isMax:function(){return this.multiple&&this.value.length>=this.max||!this.multiple&&this.value},isReplace:function(){return-1!==this.pickIndex},miniWidth:function(){return this.$store.state.miniWidth},arrayValue:function(){return this.value?Array.isArray(this.value)?this.value:[this.value]:[]},mediaMultiple:function(){return!this.isReplace&&this.multiple}},methods:{onPick:function(){this.canPick&&(this.dialog=!0)},onPickConfirm:function(t){var e;t=t.map(this.formatReturn),this.multiple?this.isReplace?(e=this.value,e[this.pickIndex]=t[0]):e=this.value.concat(t.slice(0,this.max-this.value.length)):e=t[0],this.$emit("input",e),this.$refs.media.clearSelected(),this.dialog=!1},formatReturn:function(t){var e=this.valueFields?this.valueFields.split(","):[];return 0===e.length?t=Object(o["a"])({},t):(e.push("path"),t=u()(t,e)),e=Object(r["a"])(new Set(e)),this.flatValue&&1===e.length?t[e[0]]:t},remove:function(t){this.multiple?this.value.splice(t,1):this.$emit("input",null)},onReplace:function(t){this.pickIndex=t,this.onPick()}},watch:{dialog:function(t){t||(this.pickIndex=-1)}}},h=p,m=(i("77f6"),i("daf7"),i("2877")),d=Object(m["a"])(h,n,a,!1,null,"03e2356c",null);e["a"]=d.exports},"6e3f":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-content",{attrs:{center:""}},[i("configs-form")],1)},a=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("lz-form",{ref:"form",attrs:{"get-data":t.getData,submit:t.onSubmit,errors:t.errors,form:t.form,"disable-stay":"","disable-redirect":"","edit-mode":""},on:{"update:errors":function(e){t.errors=e},"update:form":function(e){t.form=e}},scopedSlots:t._u([{key:"footer-append",fn:function(){return[i("a-checkbox",{model:{value:t.cache,callback:function(e){t.cache=e},expression:"cache"}},[t._v("更新缓存")])]},proxy:!0}])},t._l(t.configs,(function(e){return i("lz-form-item",{key:e.id,attrs:{prop:e.slug,label:e.name,tip:e.desc}},[i("type-input",{attrs:{type:e.type,options:e.options},model:{value:t.form[e.slug],callback:function(i){t.$set(t.form,e.slug,i)},expression:"form[i.slug]"}})],1)})),1)},o=[],s=(i("4160"),i("159b"),i("96cf"),i("1da1")),c=i("5530"),l=i("04bc"),u=i("d99d"),f=i("4d2d"),p=i("441c"),h=i("e572"),m=i("90fe"),d=(i("28de"),{name:"ConfigsForm",components:{TypeInput:p["a"],LzForm:l["a"],LzFormItem:u["a"]},data:function(){return{form:{},errors:{},configs:[],cache:Object(m["w"])(localStorage.getItem(h["a"]))}},computed:Object(c["a"])({},Object(h["f"])(["CONFIG_TYPES"]),{category:function(){return this.$route.params.categorySlug}}),methods:{getData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var i,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(f["i"])(t.category);case 2:i=e.sent,n=i.data,t.configs=n,a={},n.forEach((function(t){a[t.slug]=t.value})),t.form=a;case 8:case"end":return e.stop()}}),e)})))()},onSubmit:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(f["p"])(t.category,t.form);case 2:if(i=e.sent,n=i.data,t.category===h["e"].SLUG&&t.$store.commit("SET_CONFIG",{path:h["e"].SLUG,value:n}),!t.cache){e.next=8;break}return e.next=8,Object(f["a"])();case 8:case"end":return e.stop()}}),e)})))()}},watch:{cache:function(t){localStorage.setItem(h["a"],t)}}}),v=d,b=i("2877"),y=Object(b["a"])(v,r,o,!1,null,null,null),g=y.exports,k=i("33c7"),x={name:"ConfigValuesForm",components:{PageContent:k["a"],ConfigsForm:g}},I=x,S=Object(b["a"])(I,n,a,!1,null,null,null);e["default"]=S.exports},"77f6":function(t,e,i){"use strict";var n=i("cae9"),a=i.n(n);a.a},a41d:function(t,e,i){},c8d2:function(t,e,i){var n=i("d039"),a=i("5899"),r="​᠎";t.exports=function(t){return n((function(){return!!a[t]()||r[t]()!=r||a[t].name!==t}))}},cae9:function(t,e,i){},daf7:function(t,e,i){"use strict";var n=i("a41d"),a=i.n(n);a.a}}]);
//# sourceMappingURL=chunk-43959db9.d52fcf4c.js.map